<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>星豆系统 - 沪乐锦公寓</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:-apple-system, system-ui, "Microsoft Yahei", sans-serif;background:#fff5ec;color:#333;}
    header{background:#ff7f32;color:#fff;padding:15px;font-size:22px;font-weight:700;}
    nav{background:#fff;padding:10px;display:flex;flex-wrap:wrap;gap:12px;}
    nav a{color:#ff7f32;text-decoration:none;padding:6px 10px;border-radius:6px;}
    nav a.active{background:#ffeadf;}
    main{padding:20px;}
    h1{margin-bottom:10px;}
    section{margin-bottom:20px;}
    #starBalance{font-size:24px;font-weight:bold;margin-top:8px;}
    .exchange-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;}
    .exchange-item{background:#fff;border:1px solid #f6e9df;border-radius:8px;padding:10px;text-align:center;}
    .exchange-item button{margin-top:8px;background:#ff7f32;color:#fff;border:none;border-radius:6px;padding:6px 10px;cursor:pointer;}
    .log-item{background:#fff;border:1px solid #f6e9df;border-radius:8px;padding:10px;margin-bottom:8px;}
  </style>
</head>
<body>
  <header>星豆系统</header>
  <nav>
    <a href="dashboard.html">总览</a>
    <a href="rooms.html">房源管理</a>
    <a href="tenants.html">租户中心</a>
    <a href="facilities.html">娱乐设施</a>
    <a href="orders.html">抢单中心</a>
    <a href="stars.html" class="active">星豆系统</a>
    <a href="statistics.html">数据统计</a>
    <a href="contracts.html">合同管理</a>
    <a href="profile.html">个人中心</a>
  </nav>
  <main>
    <section>
      <h2>星豆余额</h2>
      <div id="starBalance">-- 星豆</div>
    </section>
    <section>
      <h2>星豆兑换</h2>
      <div class="exchange-grid">
        <div class="exchange-item">
          <div>帮取快递</div>
          <div>(500 星豆 = 50 元)</div>
          <button disabled>立即兑换</button>
        </div>
        <div class="exchange-item">
          <div>清洁房屋</div>
          <div>800 星豆</div>
          <button disabled>立即兑换</button>
        </div>
        <div class="exchange-item">
          <div>抵扣租房</div>
          <div>1200 星豆</div>
          <button disabled>立即兑换</button>
        </div>
        <div class="exchange-item">
          <div>KTV包厨一小时</div>
          <div>300 星豆</div>
          <button disabled>立即兑换</button>
        </div>
      </div>
    </section>
    <section>
      <h2>星豆明细</h2>
      <div id="starLogs"></div>
    </section>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabase-adapter.js"></script>
  <script>
    async function renderStars() {
      const { data: balData, error: balError } = await supabase.from('stars').select('*');
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>星豆系统 - 沪乐锦公寓</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:-apple-system, system-ui, "Microsoft Yahei", sans-serif;background:#fff5ec;color:#333;}
    header{background:#ff7f32;color:#fff;padding:15px;font-size:22px;font-weight:700;}
    nav{background:#fff;padding:10px;display:flex;flex-wrap:wrap;gap:12px;}
    nav a{color:#ff7f32;text-decoration:none;padding:6px 10px;border-radius:6px;}
    nav a.active{background:#ffeadf;}
    main{padding:20px;}
    h1{margin-bottom:10px;}
    section{margin-bottom:20px;}
    #starBalance{font-size:24px;font-weight:bold;margin-top:8px;}
    .exchange-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;}
    .exchange-item{background:#fff;border:1px solid #f6e9df;border-radius:8px;padding:10px;text-align:center;}
    .exchange-item button{margin-top:8px;background:#ff7f32;color:#fff;border:none;border-radius:6px;padding:6px 10px;cursor:pointer;}
    .log-item{background:#fff;border:1px solid #f6e9df;border-radius:8px;padding:10px;margin-bottom:8px;}
  </style>
</head>
<body>
  <header>星豆系统</header>
  <nav>
    <a href="dashboard.html">总览</a>
    <a href="rooms.html">房源管理</a>
    <a href="tenants.html">租户中心</a>
    <a href="facilities.html">娱乐设施</a>
    <a href="orders.html">抢单中心</a>
    <a href="stars.html" class="active">星豆系统</a>
    <a href="statistics.html">数据统计</a>
    <a href="contracts.html">合同管理</a>
    <a href="profile.html">个人中心</a>
  </nav>
  <main>
    <section>
      <h2>星豆余额</h2>
      <div id="starBalance">-- 星豆</div>
    </section>
    <section>
      <h2>星豆兑换</h2>
      <div class="exchange-grid">
        <div class="exchange-item">
          <div>帮取快递</div>
          <div>(500 星豆 = 50 元)</div>
          <button disabled>立即兑换</button>
        </div>
        <div class="exchange-item">
          <div>清洁房屋</div>
          <div>800 星豆</div>
          <button disabled>立即兑换</button>
        </div>
        <div class="exchange-item">
          <div>抵扣租房</div>
          <div>1200 星豆</div>
          <button disabled>立即兑换</button>
        </div>
        <div class="exchange-item">
          <div>KTV包厨一小时</div>
          <div>300 星豆</div>
          <button disabled>立即兑换</button>
        </div>
      </div>
    </section>
    <section>
      <h2>星豆明细</h2>
      <div id="starLogs"></div>
    </sec  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabase-adapter.js"></script>
  <script>
    async function renderStars() {
      const { data: balData, error: balError } = await supabase.from('stars').select('*');
      const balEl = document.getElementById('starBalance');
      if (balError || !balData) {
        balEl.textContent = '\u52a0\u8f7d\u5931\u8d25';
      } else {
        const bal = balData.length ? balData[0].balance : 0;
        balEl.textContent = bal + ' \u661f\u8c46';
      }
      const { data: logs, error: logError } = await supabase.from('starlogs').select('*').order('ts', { ascending: false });
      const logEl = document.getElementById('starLogs');
      if (logError || !logs) {
        logEl.innerHTML = '<p>\u52a0\u8f7d\u5931\u8d25</p>';
      } else {
        if (logs.length === 0) {
          logEl.innerHTML = '<p>\u6682\u65e0\u660e\u7ec6</p>';
        } else {
          logEl.innerHTML = logs.map(l => {
            const sign = l.amount > 0 ? '+' : '';
            return '<div class="log-item">' +
              '<div><b>' + l.type + '</b> ' + sign + l.amount + '</div>' +
              '<div>' + (l.note || '') + '</div>' +
              '<div>' + new Date(l.ts).toLocaleString() + '</div>' +
              '</div>';
          }).join('');
        }
      }
    }
    renderStars();
  </script>
</body>
</html>tion>
  </main>
      const balEl = document.getElementById('starBalance');
      if (balError || !balData) {
        balEl.textContent = '加载失败';
      } else {
        const bal = balData.length ? balData[0].balance : 0;
        balEl.textContent = bal + ' 星豆';
      }
      const { data: logs, error: logError } = await supabase.from('starlogs').select('*').order('ts', { ascending: false });
      const logEl = document.getElementById('starLogs');
      if (logError || !logs) {
        logEl.innerHTML = '<p>\u52a0\u8f7d\u5931\u8d25</p>';
      } else {
        if (logs.length === 0) {
          logEl.innerHTML = '<p>\u6682\u65e0\u660e\u7ec6</p>';
        } else {
          logEl.innerHTML = logs.map(l => {
            const sign = l.amount > 0 ? '+' : '';
            return '<div class="log-item">' +
              '<div><b>' + l.type + '</b> ' + sign + l.amount + '</div>' +
              '<div>' + (l.note || '') + '</div>' +
              '<div>' + new Date(l.ts).toLocaleString() + '</div>' +
              '</div>';
          }).join('');
        }
      }
    }
    renderStars();
  </script>
</body>
</html>
